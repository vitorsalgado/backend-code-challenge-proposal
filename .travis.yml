language: java

jdk:
  - oraclejdk13

sudo: required

before_cache:
  - rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
  - rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
    - $HOME/.gradle/caches/
    - $HOME/.gradle/wrapper/

jobs:
  include:
    - stage: validation
      name: Code Challenge Validation
      if: type = pull_request AND fork = true
      script:
          - if [ -e build.gradle ]; then ./gradlew check ; fi
          - if [ -e pom.xml ]; then mvn test -B ; fi
      notifications:
        slack: vtrsalgado:J4NygsuDQPf4qkIxn2sCG7h3
          on_success: change
          on_failure: always
